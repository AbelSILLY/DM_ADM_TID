---
title: "TP1_ADM"
author: "Arthur TENA"
date: "10/3/2023"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(ggplot2)
library(gridExtra)
library(FactoMineR)
```

## Exercice 1 :question 1

```{r}
WINE=read.csv("/Users/arthurtena/Documents/wine.csv")
WINE
```

```{r}
W=diag(1/21, 21) # matrice des poids
I_21=diag(1, 21) #matrice identité de taille 21
Quan=WINE[,4:32]
Q=matrix(0, nrow=21, ncol=29) #matrice des variables quantitatives
for(j in 1:29){ 
  Q[,j]=Quan[[j]]
}

x_b=t(Q)%*%W%*%I_21
x_bt=t(x_b)
x_c=Q - I_11%*%t(x_b) # le projecteur orthogonal sur I_21
vec_norm=diag(diag(t(x_c)%*%W%*%x_c)) #normes des vecteurs
print(vec_norm)
x_c=x_c%*%solve(sqrt(vec_norm)) #normalisation des projetes
bar=t(x_c)%*%W%*%I_21 
barycentre=t(bar)
print(barycentre)
inertie=sum(diag(t(x_c)%*%W%*%x_c))
print(inertie)
```

## Exercice 1 : question 2

```{r}
WINE
Bourg=subset(WINE, WINE$Label=='Bourgueuil')
Bourg2=Bourg[,4:32]
B=matrix(0, nrow=6, ncol=29)
Chin=subset(WINE, WINE$Label=='Chinon')
Chin2=Chin[,4:32]
C=matrix(0, nrow=4, ncol=29)
Saum=subset(WINE, WINE$Label=='Saumur')
Saum2=Saum[,4:32]
S=matrix(0, nrow=11, ncol=29)

for(j in 1:29){ 
  B[,j]=Bourg2[[j]] ## je crée la matrice B avec les informations sur les bourgueui
}

for(j in 1:29){ 
  C[,j]=Chin2[[j]] ## je crée la matrice C avec les informations sur les chinon
}

for(j in 1:29){ 
  S[,j]=Saum2[[j]]  ## je crée la matrice S avec les informations sur les saumur
}

Poids_Chinon=0
Poids_Bourgueuil=0
Poids_Saumur=0
for (i in 1:21){
   if(WINE[i,2]=="Bourgueuil"){Poids_Bourgueuil = Poids_Bourgueuil+1}
  else if(WINE[i,2]=="Chinon"){Poids_Chinon = Poids_Chinon+1}
  else { Poids_Saumur = Poids_Saumur+1}
}

POIDS_Bourgueuil=Poids_Bourgueuil/21
POIDS_Chinon=Poids_Chinon/21
POIDS_Saumur=Poids_Saumur/21
W_B=diag(POIDS_Bourgueuil, 6)
I_6=diag(1, 6)
W_C=diag(POIDS_Chinon, 4)
I_4=diag(1, 4)
W_S=diag(POIDS_Saumur, 11)
I_11=diag(1,11)

# calcul du barycentre de bourgueuil 
x_bg=t(B)%*%W_B%*%I_6
x_bgt=t(x_bg)
x_bc=B-I_6%*%x_bgt
vec_norm_b=diag(diag(t(x_bc)%*%W_B%*%x_bc))
x_bc=x_bc%*%solve(sqrt(vec_norm_b))
bar=t(x_bc)%*%W_B%*%I_6 
barycentre_b=t(bar)
#print(barycentre_b)

# calcul du barycentre de chinon 
x_cg=t(C)%*%W_C%*%I_4
x_cgt=t(x_cg)
x_cc=C-I_4%*%x_cgt
vec_norm_c=diag(diag(t(x_cc)%*%W_C%*%x_cc))
x_bc=x_bc%*%solve(sqrt(vec_norm_c))
bar=t(x_cc)%*%W_C%*%I_4 
barycentre_c=t(bar)
#print(barycentre_c)

# calcul du barycentre de bourgueuil 
x_sg=t(S)%*%W_S%*%I_11
x_sgt=t(x_sg)
x_sc=S-I_11%*%x_sgt
vec_norm_s=diag(diag(t(x_sc)%*%W_S%*%x_sc))
x_sc=x_sc%*%solve(sqrt(vec_norm_s))
bar=t(x_sc)%*%W_S%*%I_11 
barycentre_s=t(bar)
#print(barycentre_s)

## Calcul de la norme carré des barycentres :
#Bourgueuil :
for (i in 1:6){
  for (j in 1:29){
    barycentre_b[i,j]=barycentre_b[i,j]^2
    norme_eu_b=sum(barycentre_b[i,j])
  }
}

#Chinon :
for (i in 1:4){
  for (j in 1:29){
    barycentre_c[i,j]=barycentre_c[i,j]^2
    norme_eu_c=sum(barycentre_c[i,j])
  }
}

#Saumur :
for (i in 1:11){
  for (j in 1:29){
    barycentre_s[i,j]=barycentre_s[i,j]^2
    norme_eu_s=sum(barycentre_s[i,j])
  }
}
print(c(norme_eu_s, norme_eu_c, norme_eu_b))

```
