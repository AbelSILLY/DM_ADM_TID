---
title: "TP1_ADM"
author: "Arthur TENA"
date: "10/3/2023"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(ggplot2)
library(gridExtra)
library(FactoMineR)
```

## Exercice 1 :question 1

```{r}
WINE=read.csv("/Users/arthurtena/Documents/wine.csv")
WINE
```

```{r}
W=diag(1/21, 21) # matrice des poids
I_11=diag(1, 21) #matrice identit√© de taille 11
Quan=WINE[,4:32]
Q=matrix(0, nrow=21, ncol=29) #matrice des variables quantitatives
for(j in 1:29){ 
  Q[,j]=Quan[[j]]
}

x_b=t(Q)%*%W%*%I_11
x_bt=t(x_b)
x_c=Q - I_11%*%t(x_b) # le projecteur orthogonal sur I_41
vec_norm=diag(diag(t(x_c)%*%W%*%x_c)) #normes des vecteurs
print(vec_norm)
x_c=x_c%*%solve(sqrt(vec_norm)) #normalisation des projetes
bar=t(x_c)%*%W%*%I_11 
barycentre=t(bar)
print(barycentre)
inertie=sum(diag(t(x_c)%*%W%*%x_c))
print(inertie)
```

##Exercice 1 : question 2

```{r}
WINE
#Bourg=subset(WINE, WINE$Label=='Bourgueuil')
#Bourg2=Bourg[,4:32]
#B=matrix(0, nrow=6, ncol=29)
#Chin=subset(WINE, WINE$Label=='Chinon')
#Chin2=Chin[,4:32]
#C=matrix(0, nrow=4, ncol=29)
#Saum=subset(WINE, WINE$Label=='Saumur')
#Saum2=Saum[,4:32]

Poids_Chinon=0
Poids_Bourgueuil=0
Poids_Saumur=0
for (i in 1:21){
   if(WINE[i,2]=="Bourgueuil"){Poids_Bourgueuil = Poids_Bourgueuil+1}
  else if(WINE[i,2]=="Chinon"){Poids_Chinon = Poids_Chinon+1}
  else { Poids_Saumur = Poids_Saumur+1}
}

POIDS_Bourgueuil=Poids_Bourgueuil/21
POIDS_Chinon=Poids_Chinon/21
POIDS_Saumur=Poids_Saumur/21
POIDS_Bourgueuil
POIDS_Chinon
POIDS_Saumur
sum(POIDS_Bourgueuil,POIDS_Chinon,POIDS_Saumur)
```
